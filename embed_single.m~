function y = embed_single(event,single, single_sign, offset, sigma)
    y = zeros(size(event));
    ndat = length(event);
    idx = find(event);
    n_single = length(single);
    n_idx = length(idx);
    st = idx + offset;
    ed = st + n_single-1;
    s = 1+sigma*randn(n_idx,1);
    for n=1:n_idx
       if st(n)<=0 || st(n) > ndat
           continue;
       end
       if ed(n)<=0 || ed(n) > ndat
           continue
       end
       y(st(n):ed(n)) = sign(single_sign)*single; 
    end

end